# äº‹ä»¶è¯¦æƒ… Event Details

## é¼ æ ‡äº‹ä»¶
* `click`
* `dbclick`
* `contextmenu`
* `mousedown`
* `mouseup`
* `mousemove`
* `mouseover`
* `mouseout`

äº‹ä»¶é¡ºåº `mousedown` â†’ `mouseup` â†’ `click`

çª—å£åæ ‡ `event.clientX` `event.clientY`

æ–‡æ¡£åæ ‡ `event.pageX` `event.pageY`

é€‰ä¸­æ•ˆæœ `user-select: none`

## é”®ç›˜äº‹ä»¶
* `keydown`
* `keyup`

é”®ä¿¡æ¯ `event.key` `event.code` `event.keyCode`

ä¿®é¥°é”® `event.altKey` `event.ctrlKey` `event.shiftKey` `event.metaKey`(Mac Command é”®)

## æ»šåŠ¨äº‹ä»¶
```javascript
document.addEventListener('scroll', function(event) {
  console.log(window.pageYOffset);
});
```
ğŸ’¡ åœ¨ `scroll` äº‹ä»¶ç›‘å¬å™¨å†…è°ƒç”¨ `event.preventDefault()` æ˜¯æ— æ•ˆçš„ï¼Œå› ä¸ºæ»šåŠ¨å‘ç”Ÿå `scroll` äº‹ä»¶æ‰è§¦å‘ã€‚

åœ¨æŸäº›å¯ä»¥è§¦å‘æ»šåŠ¨çš„äº‹ä»¶(å¦‚æŒ‰ â–¼ é”®)çš„ç›‘å¬å™¨å†…è°ƒç”¨ `event.preventDefault()` å¯ä»¥é˜»æ­¢æ»šåŠ¨å‘ç”Ÿã€‚
```javascript
document.addEventListener('keydown', function(event) {
  if (event.key === 'ArrowDown' && window.pageYOffset > 200) event.preventDefault();
});
```

## åŠ è½½äº‹ä»¶
### é¡µé¢åŠ è½½
* `DOMContentLoaded` HTML åŠ è½½å®Œæ¯•ï¼ŒDOM æ ‘æ„å»ºå®Œæˆï¼Œå¤–éƒ¨èµ„æºå¦‚å›¾ç‰‡ï¼Œ`<iframe>` (å¾ˆ)å¯èƒ½æœªå®Œå…¨è¢«åŠ è½½ã€‚
* `load` å¤–éƒ¨èµ„æº(å¦‚å›¾ç‰‡)åŠ è½½å®Œæ¯•
* `beforeunload` ç”¨æˆ·å³å°†ç¦»å¼€é¡µé¢
* `unload` ç”¨æˆ·ç¦»å¼€é¡µé¢

#### DOMContentLoaded
`DOMContentLoaded` äº‹ä»¶åœ¨ `document` ä¸Šè§¦å‘ï¼Œå› æ­¤è¦åœ¨ `document` ä¸Šç›‘å¬æ­¤äº‹ä»¶ã€‚
```html
<img id="img" src="https://octodex.github.com/images/catstello.png">

<script>
  document.addEventListener('DOMContentLoaded', function() {
    console.log('DOMContentLoaded');
 Â   console.log('å›¾ç‰‡å¤§å°', img.offsetWidth, img.offsetHeight);  // å›¾ç‰‡å¤§å° 0 0 (å›¾ç‰‡æ²¡è¢«ç¼“å­˜çš„æƒ…å†µä¸‹)
  });
</script>
```
#### DOMContentLoaded ä¸å¤–éƒ¨æ ·å¼è¡¨
`DOMContentLoaded` **ä¸ä¼š**ç­‰å¾…å¤–éƒ¨æ ·å¼è¡¨çš„åŠ è½½ï¼Œå› æ­¤è¯¥äº‹ä»¶çš„è§¦å‘äº‹ä»¶ä¸å¤–éƒ¨æ ·å¼è¡¨æ˜¯å¦åŠ è½½å®Œæˆ**æ— å…³**ã€‚

å…³äº `DOMContentLoaded` è§¦å‘æ—¶ï¼Œæ ·å¼è¡¨æ˜¯å¦å·²ç»åŠ è½½å®Œæˆçš„é—®é¢˜ï¼Œåœ¨ Chrome ä¸­é€šè¿‡æ¨¡æ‹Ÿæ…¢ç½‘é€Ÿå¾—åˆ°ä¸‹åˆ—ç»“æœã€‚

* è‹¥æ ·å¼è¡¨éƒ½åœ¨ `<head>` ä¸­(é€šå¸¸æƒ…å†µ)ï¼Œå½“ `DOMContentLoaded` è§¦å‘æ—¶ï¼Œæ ·å¼è¡¨éƒ½å·²ç»åŠ è½½å®Œæˆã€‚

* ä¸Šè¿°æƒ…å†µä¸­ `<link>` è‹¥å¸¦æœ‰ `media` å±æ€§ï¼Œé‚£ä¹ˆè¯¥æ ·å¼è¡¨å¯èƒ½åœ¨ `DOMContentLoaded` ä¹‹ååŠ è½½å®Œæˆã€‚   
  https://octodex.github.com
  
* è‹¥æ ·å¼è¡¨å¤„äºæ–‡æ¡£ä¸­éƒ¨/å°¾éƒ¨(å¾ˆå°‘è¿™ä¹ˆåš)ï¼Œé‚£ä¹ˆåœ¨ `DOMContentLoaded` è§¦å‘æ—¶ï¼Œæ ·å¼è¡¨é€šå¸¸è¿˜æœªå®ŒæˆåŠ è½½ã€‚

#### DOMContentLoaded ä¸ <script>
`<script>` ä¼šé˜»å¡**åç»­æ–‡æ¡£**çš„è§£æï¼Œå› æ­¤ `DOMContentLoaded` ä¼šç­‰å¾… `<script>` åŠ è½½å®Œæˆã€‚

å¸¦æœ‰ `async` æˆ– `defer` å±æ€§çš„å¤–éƒ¨è„šæœ¬**ä¸ä¼š**é˜»å¡æ–‡æ¡£çš„è§£æã€‚

å¸¦æœ‰ `async` å±æ€§çš„å¤–éƒ¨è„šæœ¬ä¸€æ—¦ä¸‹è½½å®Œæˆä¾¿æ‰§è¡Œï¼Œä¸ `DOMContentLoaded` æ— å…³ã€‚`async` é€‚ç”¨äºå®Œå…¨ç‹¬ç«‹çš„è„šæœ¬ã€‚

å¸¦æœ‰ `defer` å±æ€§çš„å¤–éƒ¨è„šæœ¬æŒ‰ç…§æ–‡æ¡£ä¸­çš„å‡ºç°é¡ºåºï¼Œåœ¨æ–‡æ¡£åŠ è½½å’Œè§£æå®Œæˆåï¼Œ`DOMContentLoaded` è§¦å‘ä¹‹å‰æ‰§è¡Œã€‚

#### window.onload
`window` ä¸Šçš„ `load` äº‹ä»¶åœ¨æ–‡æ¡£å’Œå¤–éƒ¨èµ„æºéƒ½åŠ è½½å®Œæˆåè§¦å‘ã€‚
```html
<img id="img" src="https://octodex.github.com/images/catstello.png">

<script>
  window.onload = function() {
 Â   console.log('å›¾ç‰‡å¤§å°', img.offsetWidth, img.offsetHeight);  // å›¾ç‰‡å¤§å° 896 896
  };
</script>
```
#### window.onunload
å½“ç”¨æˆ·ç¦»å¼€é¡µé¢æˆ–å…³é—­çª—å£æ—¶è§¦å‘ `unload` äº‹ä»¶ï¼Œå¯åœ¨æ­¤æ—¶æ‰§è¡Œä¸€äº›æ¸…é™¤æ“ä½œã€‚
```javascript
window.onunload = function() {
  localStorage.removeItem('loggedIn');
};
```

#### window.onbeforeunload
è‹¥ç”¨æˆ·å³å°†ç¦»å¼€é¡µé¢æˆ–å…³é—­çª—å£ï¼Œå¯ä»¥é€šè¿‡ `beforeunload` å¼¹å‡ºæç¤ºçª—å£ã€‚
```javascript
window.addEventListener('beforeunload', function (e) {
  var message = "é¡µé¢åŒ…å«æœªä¿å­˜çš„æ”¹åŠ¨ï¼Œç¡®å®šè¦ç¦»å¼€ï¼Ÿ"; Â  // è‡ªå®šä¹‰æç¤ºè¯­å¥å·²ç»æ— æ•ˆï¼Œåªéœ€è¿”å›éç©ºå­—ç¬¦ä¸²

  e.returnValue = message;     // Gecko, Trident, Chrome 34+
  return message;              // Gecko, WebKit, Chrome <34
});
```

#### document.readyState
* `loading` æ–‡æ¡£ä»åœ¨åŠ è½½
* `interactive` æ–‡æ¡£å·²ç»åŠ è½½å¹¶è§£æå®Œæˆ(`DOMContentLoaded` å³å°†è§¦å‘)
* `complete` æ–‡æ¡£å’Œå¤–éƒ¨èµ„æºéƒ½å·²ç»åŠ è½½å®Œæˆ(`window.onload` å³å°†è§¦å‘)

### èµ„æºåŠ è½½
* `onload` èµ„æºåŠ è½½æˆåŠŸ
* `onerror` èµ„æºåŠ è½½å¤±è´¥

ğŸŒ° é€šè¿‡è„šæœ¬åŠ è½½å›¾ç‰‡
```javascript
let img = new Image();
img.src = 'https://octodex.github.com/images/catstello.png';
img.onload = function() { console.log('å›¾ç‰‡å¤§å°', this.offsetWidth, this.offsetHeight); }
img.onerror = function() { console.log('åŠ è½½å¤±è´¥', this.src);  }

document.body.appendChild(img);
```
ğŸ’¡ è¿˜å¯ä»¥é€šè¿‡è„šæœ¬åŠ è½½è„šæœ¬å’Œæ ·å¼ã€‚

## å‚è€ƒé“¾æ¥
* https://javascript.info/onscroll
* https://javascript.info/mouse-events-basics
* https://javascript.info/mouse-drag-and-drop
* https://javascript.info/onload-ondomcontentloaded
* https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script
* https://developer.mozilla.org/en-US/docs/Web/Events/beforeunload
* https://developer.mozilla.org/en-US/docs/Web/API/Document/readyState
* http://www.growingwiththeweb.com/2014/02/async-vs-defer-attributes.html
* https://javascript.info/mousemove-mouseover-mouseout-mouseenter-mouseleave
