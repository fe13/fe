# Express 简介

Express 是一个非常流行的 Node Web 框架。

> Fast, unopinionated, minimalist web framework for Node.js

## Hello Express
1. `npm init -y` 新建 `package.json` 文件

2. 运行以下命令下载 Express
```bash
$ npm install express --save
```
3. 将以下代码保存成 `app.js`，运行 `node app.js` 并访问 http://localhost:3000 。
```javascript
const express = require('express');     // 引入 express 模块
const app = express();                  // 新建 express app

app.get('/', function(req, res) {       // 处理 '/' 的 GET 请求
  res.send('Hello Express!');           // 返回 'Hello Express!'
});

app.listen(3000, function() {           // 监听端口 3000
  console.log('服务器运行在端口 3000');
});
```

## 静态文件服务器
目录结构 https://github.com/twhy/express-everything/tree/master/static

```javascript
const express = require('express');
const app = express();

app.use(express.static('public'));      // public 文件夹存放静态文件如 CSS 图片等

app.listen(3000, function() {
  console.log('Server listening on port 3000');
});
```
通过 `node app.js` 启动服务器，访问 http://localhost:3000/cat.html 或 http://localhost:3000/styles/cat.css 。

## 渲染页面
安装包 `express` 和 `pug`，后者是一个模板引擎。
```bash
$ npm install express --save
$ npm install pug --save
```
`app.js`
```javascript
const path = require('path');
const express = require('express');
const app = express();

app.set('views', path.join(__dirname, 'views'));      // 设置 views 目录路径
app.set('view engine', 'pug');                        // 使用 pug 作为模板引擎

const CATS = [
  { name: "the Dinotocat", image: "https://octodex.github.com/images/dinotocat.png" },
  { name: "the Benjamin Bannekat", image: "https://octodex.github.com/images/bannekat.png" },
  { name: "the Catstello", image: "https://octodex.github.com/images/catstello.png" }
];

app.get('/', function(req, res) {
  res.render('index', { cats: CATS });
});

app.listen(3000, function() {
  console.log('Server listening on port 3000');
});
```
页面模板 `index.pug`
```pug
<!DOCTYPE html>
html(lang="en")
  head
    meta(charset="UTF-8")
    meta(name="viewport", content="width=device-width, initial-scale=1.0")
    meta(http-equiv="X-UA-Compatible", content="ie=edge")
    style.
      body { text-align: center; }
    title Cats
  body
    h1 Cats 
    each cat in cats
      img(src=`${cat.image}` alt=`${cat.name}` width="230")
```

## 模拟请求
我们可以使用 Express 模拟 `GET` `POST` `PUT` `DELETE` 等各种请求结果，这在项目开发期间相当有用。

安装 `express` `pug` `body-parser`，其中 `body-parser` 用于解析请求体(Request Body)。
```bash
$ npm install express --save
$ npm install pug --save
$ npm install body-parser --save
```

## 参考链接
* http://expressjs.com
* https://expressjs.com/en/4x/api.html#app
* https://expressjs.com/en/4x/api.html#app.settings.table
* http://expressjs.com/en/guide/error-handling.html
* http://expressjs.com/en/guide/routing.html#express-router
* https://expressjs.com/en/guide/routing.html#response-methods
* http://expressjs.com/en/resources/middleware.html
* https://developer.mozilla.org/en-US/docs/Learn/Server-side/Express_Nodejs/Introduction
